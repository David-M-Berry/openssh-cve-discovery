# python-nmap-openssh-version-scans
Scanning for open SSH connections (regardless of port) and reporting hostname and openssh versions 

## Background

On July 1, 2024, a new OpenSSH unauthenticated remote code execution (RCE) vulnerability
dubbed regreSSHion was reported, affecting glibc-based Linux systems. This vulnerability, identified as **CVE-2024-6387**, allows remote attackers to execute arbitrary code as root due to a signal handler race condition in sshd.

This vulnerability, if exploited, could lead to full system compromise, where an attacker can
execute arbitrary code with the highest privileges, resulting in a complete system takeover,
installation of malware, data manipulation, and the creation of backdoors for persistent access.
It could facilitate network propagation, allowing attackers to use a compromised system as a
foothold to traverse and exploit other vulnerable systems within the organization.

## Versions Affected

- The regreSSHion flaw impacts OpenSSH servers on Linux from version 8.5p1 up to, but not
including 9.8p1.

- Versions 4.4p1 up to, but not including 8.5p1 are not vulnerable to CVE-2024-6387 thanks to
a patch for CVE-2006-5051, which secured a previously unsafe function.

- Versions older than 4.4p1 are vulnerable to regreSSHion unless they are patched for CVE-2006-
5051 and CVE-2008-4109. OpenBSD systems are not impacted by this flaw thanks to a secure
mechanism introduced back in 2001

# Remediation

Openssh patched will need to be applied across various linux distributions. In order to know which systems require a patch, it may be necessary to scan the network for servers listening for SSH connections.

It is often a best practice to setup SSH on ports that are not the default (22). In this case, discovery can be more complicated.

# Python Script for Vulnerable OpenSSH version Discovery

